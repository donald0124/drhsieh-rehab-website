---
import BaseLayout from '../../layouts/BaseLayout.astro';

// 1. 從 'astro:content' 匯入 "型別" (CollectionEntry)
import { getCollection, type CollectionEntry } from 'astro:content';

// 2. 明確宣告 posts 的型別是 CollectionEntry<'blog'> 的 "陣列"
const posts: CollectionEntry<'blog'>[] = (await getCollection('blog')).sort(
    
    // 3. 明確宣告 a 和 b 的型別
    (a: CollectionEntry<'blog'>, b: CollectionEntry<'blog'>) => 
        b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<BaseLayout title="衛教資訊 | 謝明福復健科診所" description="診所最新衛教資訊、文章與媒體報導。">

    <section id="blog-hero" style="text-align: center; padding: 4rem 1rem; background-color: var(--color-primary-light);">
        <h1>衛教資訊 & 媒體報導</h1>
        <p>我們分享最新的復健知識、疼痛治療新知與媒體專訪。</p>
        </section>

    <section id="blog-list" style="padding: 4rem 1rem;">
        <div class="container" style="max-width: 900px; margin: 0 auto;">

            <div class="posts-grid" style="display: grid; grid-template-columns: 1fr; gap: 2rem;">

                {posts.map(post => (
                    <a href={`/blog/${post.slug}/`} class="post-card" style="
                        display: block; 
                        background: #fff; 
                        border: 1px solid var(--color-border); 
                        border-radius: 8px; 
                        overflow: hidden; 
                        text-decoration: none;
                        transition: transform 0.3s ease, box-shadow 0.3s ease;
                    ">
                        {post.data.heroImage && (
                            <img src={post.data.heroImage} alt={post.data.title} style="width: 100%; height: 200px; object-fit: cover;">
                        )}

                        <div class="card-content" style="padding: 1.5rem;">
                            <h3 style="margin: 0 0 0.5rem; color: var(--color-primary);">{post.data.title}</h3>
                            <p style="margin: 0 0 1rem; color: var(--color-text);">{post.data.description}</p>
                            <span style="font-size: 0.9rem; color: #777;">
                                {post.data.pubDate.toLocaleDateString('zh-TW', { year: 'numeric', month: 'long', day: 'numeric' })}
                            </span>
                        </div>
                    </a>
                ))}

            </div>
        </div>
    </section>

    <section id="info" style="background-color: var(--color-gray-bg);">
        <div class="container" style="max-width: 1100px; margin: 0 auto;">
            <h2>媒體報導 & 連結</h2>
            <div class="service-cards-container">
                <div class="card">
                    <h3>LINE AI 智能客服</h3>
                    <p>快速了解診所資訊...<br><a href="https://reurl.cc/VY92XZ" target="_blank">點此加入</a></p>
                </div>
                <div class="card"><h3>《聚焦2.0》專訪</h3><p>...<br><a href="https://bit.ly/drhsieh_interview" target="_blank">觀看影片</a></p></div>
                <div class="card"><h3>《良醫健康網》專訪</h3><p>...<br><a href="https://bit.ly/drhsieh_interview2" target="_blank">閱讀文章</a></p></div>
                <div class="card"><h3>院長部落格</h3><p>...<br><a href="https://bit.ly/drhsieh_blog" target="_blank">前往部落格</a></p></div>
            </div>
        </div>
    </section>

    <style>
        /* 讓部落格卡片在桌面上變兩欄 */
        @media (min-width: 768px) {
            .posts-grid {
                grid-template-columns: 1fr 1fr; /* 2 欄 */
            }
        }

        .post-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        }
    </style>

</BaseLayout>